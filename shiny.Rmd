---
output: html_document
runtime: shiny
---


# Shiny app to look at model results from CV folds - NOT WORKING RIGHT NOW

```{r}
library(shiny)
# Define UI for application that draws a histogram

mods.pls.test <- list()
for(i in 1:10){
  mods.pls.test[[i]] <- plot(mods.pls[[i]]) 
}
plot(mods.pls.test[[1]])




ui <- fluidPage(
  # Application title
  titlePanel("PLS Model Results"),
  ## Panel with selectInput dropdown and output options
  pageWithSidebar(
    headerPanel("Select CV-Fold:"),
    sidebarPanel(
      selectInput("select",
              "Select model:",
              list("PLS - no VIP" = list("Model 1" = mods.pls[[1]], "Model 2" = mods.pls[[2]], "Model 3" = mods.pls[[3]], 
                              "Model 4" = mods.pls[[4]], "Model 5" = mods.pls[[5]], "Model 6" = mods.pls[[6]], 
                              "Model 7" = mods.pls[[7]], "Model 8" = mods.pls[[8]], "Model 9" = mods.pls[[9]], 
                              "Model 10" = mods.pls[[10]]), 
                   "PLS - VIP" = list("Model 1" = mods.vip[[1]], "Model 2" = mods.vip[[2]], "Model 3" = mods.vip[[3]], 
                              "Model 4" = mods.vip[[4]], "Model 5" = mods.vip[[5]], "Model 6" = mods.vip[[6]], 
                              "Model 7" = mods.vip[[7]], "Model 8" = mods.vip[[8]], "Model 9" = mods.vip[[9]], 
                              "Model 10" = mods.vip[[10]]) 
                   )
              ),
    ),
    mainPanel(
      plotOutput("plot1")
    )
  )
)


# Define server logic required to draw model plot
server <- function(input, output) {
  ## plot model results
  output$plot1 <- renderPlot({
    plot(unlist(input$select))
  })
}
# Run the application
shinyApp(ui = ui, server = server)









ui <- fluidPage(
  # Application title
  titlePanel("PLS Model Results"),
  ## Panel with selectInput dropdown and output options
  pageWithSidebar(
    headerPanel("Select CV-Fold:"),
    sidebarPanel(
      selectInput("select",
              "Select model:",
              list("MLR - PCs" = list("Model 1" = mods.lm[[1]], "Model 2" = mods.lm[[2]], "Model 3" = mods.lm[[3]], 
                              "Model 4" = mods.lm[[4]], "Model 5" = mods.lm[[5]], "Model 6" = mods.lm[[6]], 
                              "Model 7" = mods.lm[[7]], "Model 8" = mods.lm[[8]], "Model 9" = mods.lm[[9]], 
                              "Model 10" = mods.pls[[10]]), 
                   "GAM - PCs" = list("Model 1" = mods.GAM[[1]], "Model 2" = mods.GAM[[2]], "Model 3" = mods.GAM[[3]], 
                              "Model 4" = mods.GAM[[4]], "Model 5" = mods.GAM[[5]], "Model 6" = mods.GAM[[6]], 
                              "Model 7" = mods.GAM[[7]], "Model 8" = mods.GAM[[8]], "Model 9" = mods.GAM[[9]], 
                              "Model 10" = mods.GAM[[10]]), 
                   "PLS - no VIP" = list("Model 1" = mods.pls[[1]], "Model 2" = mods.pls[[2]], "Model 3" = mods.pls[[3]], 
                              "Model 4" = mods.pls[[4]], "Model 5" = mods.pls[[5]], "Model 6" = mods.pls[[6]], 
                              "Model 7" = mods.pls[[7]], "Model 8" = mods.pls[[8]], "Model 9" = mods.pls[[9]], 
                              "Model 10" = mods.pls[[10]]), 
                   "PLS - VIP" = list("Model 1" = mods.vip[[1]], "Model 2" = mods.vip[[2]], "Model 3" = mods.vip[[3]], 
                              "Model 4" = mods.vip[[4]], "Model 5" = mods.vip[[5]], "Model 6" = mods.vip[[6]], 
                              "Model 7" = mods.vip[[7]], "Model 8" = mods.vip[[8]], "Model 9" = mods.vip[[9]], 
                              "Model 10" = mods.vip[[10]]) 
                   )
              ),
    ),
    mainPanel(
      plotOutput("plot1")
    )
  )
)



# ui <- fluidPage(
#   # Application title
#   titlePanel("PLS Model Results"),
#   ## Panel with selectInput dropdown and output options
#   pageWithSidebar(
#     headerPanel("Select CV-Fold:"),
#     sidebarPanel(
#       selectInput("data", "CV-Fold",
#                   choices = c("Model 1" = 1, "Model 2" = 2, "Model 3" = 3, 
#                               "Model 4" = 4, "Model 5" = 5, "Model 6" = 6, 
#                               "Model 7" = 7, "Model 8" = 8, "Model 9" = 9, 
#                               "Model 10" = 10)
#       ),
#     ),
#     mainPanel(
#       plotOutput("plot1")
#     )
#   )
# )
# # Define server logic required to draw a histogram
# server <- function(input, output) {
#   reactivedata <- reactive({
#     pls.mods[[as.integer(input$data)]]  
#   })
#   ## plot model results
#   output$plot1 <- renderPlot({
#     plot(reactivedata(), ncomp = reactivedata()$ncomp.selected )
#   })
# }
# # Run the application
# shinyApp(ui = ui, server = server)
```

